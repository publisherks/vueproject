{"version":3,"sources":["webpack:///./src/views/dashboard/set/View.vue?a05b","webpack:///./src/views/dashboard/set/View.vue","webpack:///./src/views/dashboard/set/View.vue?8751"],"names":["router","setup","grids","undefined","gridOption","column","float","widgets","widgetView","widgetRes","data","initGridStack","gridDrag","init","cellHeight","cellWidth","on","event","el","node","gridstackNode","id","parseInt","getAttribute","substr","Object","entries","forEach","key","keys","includes","saveGrid","idx","index","x","y","w","h","push","filter","value","indexOf","console","log","response","message","callback","e","no","request","name","messagePopup","status","__scopeId"],"mappings":"kHAAA,W,+fCiCc,EASJA,EAAS,iBASTC,EAAQ,eAAS,CACnBC,WAAOC,EACPC,WAAY,CACRC,OAAQ,GACRC,OAAO,GAEXC,QAAS,KAGb,eAAS,wCAAC,8FACNC,IADM,4CAIV,IAAMA,EAAU,yDAAG,oHAES,iBAFT,OAETC,EAFS,OAGfR,EAAMM,QAAUE,EAAUC,KAC1B,gBAAS,WACLC,IACAC,OANW,2CAAH,qDAUVD,EAAgB,WAClBV,EAAMC,MAAQ,eAAUW,KAAKZ,EAAMG,YACnCH,EAAMC,MAAMY,WAAWb,EAAMC,MAAMa,cAGjCH,EAAW,WACbX,EAAMC,MAAMc,GAAG,uBAAuB,SAACC,EAAOC,GAC1C,IAAIC,EAAOD,EAAGE,cACVC,EAAKC,SAASJ,EAAGK,aAAa,MAAMC,OAAO,IAAM,EACrDC,OAAOC,QAAQP,GAAMQ,SAAQ,SAACT,GAC1B,IAAIU,EAAMV,EAAG,GACDA,EAAG,GACZO,OAAOI,KAAK5B,EAAMM,QAAQc,IAAKS,SAASF,KACvC3B,EAAMM,QAAQc,GAAIO,GAAOV,EAAG,WAMtCa,EAAQ,yDAAG,4HACW,iBADX,OACPtB,EADO,OAETuB,EAAM,GACV/B,EAAMM,QAAQoB,SAAQ,SAACT,EAAIe,GACvBxB,EAAUC,KAAKiB,SAAQ,WAChB1B,EAAMM,QAAQ0B,GAAOC,IAAMzB,EAAUC,KAAKuB,GAAOC,GAC7CjC,EAAMM,QAAQ0B,GAAOE,IAAM1B,EAAUC,KAAKuB,GAAOE,GACjDlC,EAAMM,QAAQ0B,GAAOG,IAAM3B,EAAUC,KAAKuB,GAAOG,GACjDnC,EAAMM,QAAQ0B,GAAOI,IAAM5B,EAAUC,KAAKuB,GAAOI,GAEpDL,EAAIM,KAAKL,SAKrBD,EAAMA,EAAIO,QAAO,SAACC,EAAOP,GAAR,OAAkBD,EAAIS,QAAQD,KAAWP,KAC1DS,QAAQC,IAAI,MAAOX,GAEfY,EAAW,GACXC,EAAU,GACVC,OAAW3C,EAEf6B,EAAIL,QAAJ,yDAAY,WAAOoB,GAAP,gGACJC,EAAKD,EAAI,EACbL,QAAQC,IAAIK,GACNC,EAAU,CACZf,EAAGjC,EAAMM,QAAQwC,GAAGb,EACpBC,EAAGlC,EAAMM,QAAQwC,GAAGZ,EACpBC,EAAGnC,EAAMM,QAAQwC,GAAGX,EACpBC,EAAGpC,EAAMM,QAAQwC,GAAGV,GAPhB,SASS,eAAaW,EAAIC,GAT1B,OASRL,EATQ,kDAAZ,uDAYAC,EAAU,YACVC,EAAW,WACPJ,QAAQC,IAAIC,GACZ5C,EAAOsC,KAAK,CACRY,KAAM,eAIdC,EAAaN,EAASC,GA1CT,4CAAH,qDA6CRK,EAAe,SAACN,EAAS,GAC3B,eAAgB,CACZO,QAAQ,EACRP,QAASA,EACTC,SAAU,WACN,Q,24BC3IhB,EAAOO,UAAY,kBAEJ","file":"js/chunk-0f0ffeee.e8c07975.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./View.vue?vue&type=style&index=0&id=5c8e9254&lang=sass&scoped=true\"","<template>\n    <div class=\"title-box mb-30\">\n        <h2 class=\"main-title\">{{ props.title }}</h2>\n        <btn-group \n            class=\"ml-15\"\n        >\n            <btn\n                text=\"저장\"\n                kind=\"main\"\n                iconCls=\"fas fa-save\"\n                @click=\"saveGrid()\"\n            />\n        </btn-group>\n    </div>\n    <div class=\"grid-stack\">\n        <div\n            class=\"grid-stack-item\"\n            v-for=\"({x, y, w, h, id } = {}, index) in setup.widgets\"\n            v-bind:key=\"`widgets${id}`\"\n            v-bind=\"{\n                id: `widget${id}`,\n                'gs-x': x,\n                'gs-y': y,\n                'gs-w': w,\n                'gs-h': h\n            }\"\n        >\n            <div class=\"grid-stack-item-content box\">\n                item {{index}}\n            </div>\n        </div>\n    </div>\n</template>\n<script setup>\n    import { reactive, defineProps, onMounted, nextTick, watch } from \"vue\";\n    import { GridStack } from \"gridstack\";\n    import \"gridstack/dist/h5/gridstack-dd-native\";\n    import { isEmpty } from \"@/js/common/common\";\n    import { widgetList, widgetModify } from \"@/js/api/widgetApi\";\n    import { setMessageModal } from \"@/js/pattern/singleton/Modal\";\n    import { useRouter } from \"vue-router\";\n\n    const router = useRouter();\n\n    const props = defineProps({\n        title: {\n            type: String,\n            default: \"\",\n        }\n    });\n\n    const setup = reactive({\n        grids: undefined,\n        gridOption: {\n            column: 12,\n            float: true,\n        },\n        widgets: [],\n    })\n\n    onMounted(async () => {\n        widgetView();\n    })\n\n    const widgetView = async () => {\n\n        const widgetRes = await widgetList();\n        setup.widgets = widgetRes.data;\n        nextTick(() => {\n            initGridStack();\n            gridDrag();\n        });\n    }\n\n    const initGridStack = () => {\n        setup.grids = GridStack.init(setup.gridOption);\n        setup.grids.cellHeight(setup.grids.cellWidth());\n    }\n\n    const gridDrag = () => {\n        setup.grids.on('dragstop resizestop', (event, el) => {\n            let node = el.gridstackNode;\n            let id = parseInt(el.getAttribute('id').substr(6)) - 1;\n            Object.entries(node).forEach((el) => {\n                let key = el[0],\n                    value = el[1];\n                if(Object.keys(setup.widgets[id]).includes(key)) {\n                    setup.widgets[id][key] = el[1];\n                }\n            })\n        })\n    }\n\n    const saveGrid = async () => {\n        const widgetRes = await widgetList();\n        let idx = [];\n        setup.widgets.forEach((el, index) => { \n            widgetRes.data.forEach(() => { \n                if(setup.widgets[index].x !== widgetRes.data[index].x\n                    || setup.widgets[index].y !== widgetRes.data[index].y\n                    || setup.widgets[index].w !== widgetRes.data[index].w\n                    || setup.widgets[index].h !== widgetRes.data[index].h\n                ) {\n                    idx.push(index);\n                }\n            })\n        })\n\n        idx = idx.filter((value, index) => idx.indexOf(value) === index);\n        console.log(\"idx\", idx)\n        \n        let response = \"\",\n            message = \"\",\n            callback = undefined;\n\n        idx.forEach(async (e) => {\n            let no = e + 1;\n            console.log(no);\n            const request = {\n                x: setup.widgets[e].x,\n                y: setup.widgets[e].y,\n                w: setup.widgets[e].w,\n                h: setup.widgets[e].h\n            }\n            response = await widgetModify(no, request);\n        })\n\n        message = \"저장 되었습니다.\";\n        callback = () => {\n            console.log(response);\n            router.push({\n                name: \"Dashboard\",\n            });\n        };\n        \n        messagePopup(message, callback);\n    }\n\n    const messagePopup = (message, callback) => {\n        setMessageModal({\n            status: true,\n            message: message,\n            callback: () => {\n                callback();\n            }\n        });\n    };\n</script>\n\n<style lang=\"sass\" scoped>\n@import \"@/assets/scss/components/_gridstack.scss\"\n</style>\n","import script from \"./View.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./View.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./View.vue?vue&type=style&index=0&id=5c8e9254&lang=sass&scoped=true\"\nscript.__scopeId = \"data-v-5c8e9254\"\n\nexport default script"],"sourceRoot":""}